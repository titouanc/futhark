-- ==
-- input {
--   [ [ [ [1,2,3], [4,5,6] ]
--     , [ [6,7,8], [9,10,11] ]
--     ]
--   , [ [ [3,2,1], [4,5,6] ]
--     , [ [8,7,6], [11,10,9] ]
--     ]
--   ]
--   [ [ [ [4,5,6]  , [1,2,3] ]
--     , [ [9,10,11], [6,7,8] ]
--     ]
--   , [ [ [4,5,6]  , [3,2,1] ]
--     , [ [11,10,9], [8,7,6] ]
--     ]
--   ]
-- }
-- output {
--   [[[[5, 7, 9],
--      [5, 7, 9]],
--     [[15, 17, 19],
--      [15, 17, 19]]],
--    [[[7, 7, 7],
--      [7, 7, 7]],
--     [[19, 17, 15],
--      [19, 17, 15]]]]
-- }
let add1 (xs: []i32, ys: []i32): []i32 =
  map (+) xs ys

let add2 (xs: [][]i32, ys: [][]i32): [][]i32 =
  map  add1 (zip  xs ys)

let add3 (xs: [][][]i32, ys: [][][]i32): [][][]i32 =
  map  add2 (zip  xs ys)

let add4 (xs: [][][][]i32, ys: [][][][]i32): [][][][]i32 =
  map  add3 (zip  xs ys)

let main(a: [][][][]i32, b: [][][][]i32): [][][][]i32 =
  add4(a,b)
